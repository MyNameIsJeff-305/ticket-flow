# Database Schema Design

![db-diagram]

https://dbdiagram.io/d/6883de4acca18e685cccd6d0

# API Documentation

## User Authentication/Authorization

### All endpoints that require authentication

All endpoints that require a current user to be logged in.

- Request: endpoints that require authentication
- Error Response: Require authentication

  - Status Code: 401
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
      "message": "Authentication required"
    }
    ```

### All endpoints that require proper authorization

All endpoints that require authentication and the current user does not have the
correct role(s) or permission(s).

- Request: endpoints that require proper authorization
- Error Response: Require proper authorization

  - Status Code: 403
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
      "message": "Forbidden"
    }
    ```

## Users

### Get the Current User

Returns the details of the logged in user. If no logged in user, returns null.

- Require Authentication: `false`
- Request:

  - Method: `GET`
  - URL: `/api/session`
  - Body: none

- Successful Response:
  - Status Code: 200
  - Headers:
    `Content-Type: application/json`
  - Body:

```json
{
  "user": {
    "id": 1,
    "firstName": "John",
    "lastName": "Smith",
    "username": "johnsmith",
    "profilePicUrl": "https://images.ctfassets.net/h6goo9gw1hh6/2sNZtFAWOdP1lmQ33VwRN3/24e953b920a9cd0ff2e1d587742a2472/1-intro-photo-final.jpg"
  }
}
```

- Successful Response when there is no logged in user
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "user": null
}
```

### Log in

Logs in a user with valid credentials and returns the current user's information.

- Require Authentication: `false`
- Request
  - Method: `POST`
  - URL: `/api/session`
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "credential": "john.smith@gmail.com",
  "password": "password"
}
```

- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "user": {
    "id": 1,
    "email": "demo@aa.io",
    "username": "DemoEmp1",
    "firstName": "Demo",
    "lastName": "User",
    "profilePicUrl": "https://images.ctfassets.net/h6goo9gw1hh6/2sNZtFAWOdP1lmQ33VwRN3/24e953b920a9cd0ff2e1d587742a2472/1-intro-photo-final.jpg"
  }
}
```

- Error Response: Invalid Credentials
  - Status Code: 401
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Invalid Credentials"
}
```

- Error Response: Body Validation Errors
  - Status Code: 400
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Bad Request", //Or Validation Error if generated by Sequelize
  "errors": {
    "credential": "Email or username is required",
    "password": "Password is required"
  }
}
```

### Sign Up a User

Creates a new user, logs them in as the current user, and returns the current user's information.

- Require Authentication: `false`
- Request
  - Method: `POST`
  - URL: `/api/users`
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "email": "newuser@gmail.com",
  "password": "password",
  "username": "newuser33",
  "firstName": "New",
  "lastName": "User",
  "title": "Designer",
  "departmentId": 1
}
```

- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "user": {
    "id": 7,
    "email": "newuser@gmail.com",
    "username": "newuser33",
    "firstName": "New",
    "lastName": "User"
  }
}
```

- Error Response: User already exists with the specified email
  - Status Code: 500
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "User already exists",
  "errors": {
    "email": "User with this email already exists"
  }
}
```

- Error Response: User already exists with the specified username
  - Status Code: 500
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "User already exists",
  "errors": {
    "username": "User with this username already exists"
  }
}
```

- Error Response: Body Validation Errors
  - Status Code: 400
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Bad Request", //Or Validation Error if generated by Sequelize
  "errors": {
    "email": "Invalid email",
    "username": "Username is Required",
    "firstName": "First Name is required",
    "lastName": "Last Name is required"
  }
}
```

## Tickets

### Get All Tickets

Returns all the Tickets.

- Require Authentication: `true`
- Request
  - Method: `GET`
  - URL: `/api/tickets`
  - Body: none
- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
[
  {
    "id": 1,
    "title": "Network Connectivity Issues",
    "createdBy": {
      "id": 1,
      "firstName": "Demo",
      "lastName": "User",
      "profilePicUrl": "https://images.ctfassets.net/h6goo9gw1hh6/2sNZtFAWOdP1lmQ33VwRN3/24e953b920a9cd0ff2e1d587742a2472/1-intro-photo-final.jpg",
      "title": "Software Engineer",
      "username": "DemoEmp1",
      "departmentId": 1
    },
    "clientId": {
      "id": 1,
      "firstName": "Jane",
      "lastName": "Smith",
      "companyName": "",
      "email": "janesmith@techsolutions.com",
      "phoneNumber": null,
      "profilePicUrl": "https://spor12.dk/wp-content/uploads/2017/05/speaker-1.jpg",
      "createdAt": "2025-08-26T14:16:29.140Z",
      "updatedAt": "2025-08-26T14:16:29.140Z"
    },
    "description": "The office network is not working, can't connect to the internet.",
    "checkIn": null,
    "checkOut": null,
    "statusId": 1,
    "hashedId": "0XxR/v.CGH",
    "createdAt": "2025-08-26T14:16:29.146Z",
    "updatedAt": "2025-08-26T14:16:29.146Z"
  },
  {
    "id": 2,
    "title": "Slow Computer Performance",
    "createdBy": {
      "id": 2,
      "firstName": "Jane",
      "lastName": "Doe",
      "profilePicUrl": "https://www.elitesingles.com/wp-content/uploads/sites/85/2020/06/elite_singles_slide_6-350x264.png",
      "title": "Product Manager",
      "username": "DemoEmp2",
      "departmentId": 1
    },
    "clientId": {
      "id": 2,
      "firstName": "",
      "lastName": "",
      "companyName": "IT Innovators",
      "email": "mjohnson@itinnovators.io",
      "phoneNumber": null,
      "profilePicUrl": "https://governmenttechnologyinsider.com/wp-content/uploads/2018/09/shutterstock_691380820.jpg",
      "createdAt": "2025-08-26T14:16:29.140Z",
      "updatedAt": "2025-08-26T14:16:29.140Z"
    },
    "description": "My computer is very slow, it takes a long time to load applications.",
    "checkIn": null,
    "checkOut": null,
    "statusId": 1,
    "hashedId": "BSU8IfQPUe",
    "createdAt": "2025-08-26T14:16:29.146Z",
    "updatedAt": "2025-08-26T14:16:29.146Z"
  }
]
```

### Get All Tickets Assigned to the Current User

Returns all the Tickets assigned to the Current User

- Require Authentication: `true`
- Request
  - Method: `GET`
  - URL: `/api/tickets/current`
  - Body: none
- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
[
  {
    "id": 1,
    "title": "Network Connectivity Issues",
    "createdBy": 1,
    "clientId": {
      "id": 1,
      "firstName": "Jane",
      "lastName": "Smith",
      "companyName": "",
      "email": "janesmith@techsolutions.com",
      "phoneNumber": null,
      "profilePicUrl": "https://spor12.dk/wp-content/uploads/2017/05/speaker-1.jpg",
      "createdAt": "2025-08-26T14:16:29.140Z",
      "updatedAt": "2025-08-26T14:16:29.140Z"
    },
    "description": "The office network is not working, can't connect to the internet.",
    "checkIn": null,
    "checkOut": null,
    "statusId": 1,
    "hashedId": "0XxR/v.CGH",
    "createdAt": "2025-08-26T14:16:29.146Z",
    "updatedAt": "2025-08-26T14:16:29.146Z"
  }
]
```

### Get Details of a Ticket from an Id

Returns the details of a Ticket specified by its id.

- Require authentication: `true`
- Request
  - Method: `GET`
  - URL: `/api/tickets/:ticketId`
  - Body: none
- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "id": 1,
  "title": "Network Connectivity Issues",
  "description": "The office network is not working, can't connect to the internet.",
  "checkIn": null,
  "checkOut": null,
  "hashedId": "0XxR/v.CGH",
  "CreatedBy": {
    "id": 1,
    "firstName": "Demo",
    "lastName": "User",
    "profilePicUrl": "https://images.ctfassets.net/h6goo9gw1hh6/2sNZtFAWOdP1lmQ33VwRN3/24e953b920a9cd0ff2e1d587742a2472/1-intro-photo-final.jpg",
    "title": "Software Engineer",
    "username": "DemoEmp1",
    "departmentId": 1
  },
  "ClientInfo": {
    "id": 1,
    "firstName": "Jane",
    "lastName": "Smith",
    "companyName": "",
    "email": "janesmith@techsolutions.com",
    "phoneNumber": null,
    "profilePicUrl": "https://spor12.dk/wp-content/uploads/2017/05/speaker-1.jpg",
    "createdAt": "2025-08-26T14:16:29.140Z",
    "updatedAt": "2025-08-26T14:16:29.140Z"
  },
  "Parts": [
    {
      "id": 1,
      "name": "Ethernet Cable",
      "description": "Cat6 Ethernet cable for network connectivity",
      "ticketId": 1,
      "imageUrl": "https://media.startech.com/cms/products/gallery_large/n6patcxmbl.main.jpg",
      "createdAt": "2025-08-26T14:16:29.151Z",
      "updatedAt": "2025-08-26T14:16:29.151Z"
    },
    {
      "id": 2,
      "name": "Network Switch",
      "description": "5-port Gigabit Network Switch for office network",
      "ticketId": 1,
      "imageUrl": "https://intellinetsolutions.com/cdn/shop/products/24-port-gigabit-ethernet-switch-561273-1_11790351-cb3d-41e5-b877-6424af02441c.jpg",
      "createdAt": "2025-08-26T14:16:29.151Z",
      "updatedAt": "2025-08-26T14:16:29.151Z"
    },
    {
      "id": 21,
      "name": "Backup Power Supply",
      "description": "Uninterruptible Power Supply (UPS) for network devices",
      "ticketId": 1,
      "imageUrl": "https://i5.walmartimages.com.mx/mg/gm/3pp/asr/ebf7d5d3-9b04-4885-9eb3-160a4681e5d2.471379173e77c206d2cea3d05e307309.jpeg",
      "createdAt": "2025-08-26T14:16:29.151Z",
      "updatedAt": "2025-08-26T14:16:29.151Z"
    }
  ],
  "StatusInfo": {
    "id": 1,
    "name": "Open",
    "color": "#FF6B6B",
    "description": "The ticket is open and has not been assigned to anyone",
    "createdAt": "2025-08-26T14:16:29.136Z",
    "updatedAt": "2025-08-26T14:16:29.136Z"
  }
}
```

- Error Response: No Ticket Found
  - Status Code: 404
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Ticket not found"
}
```

### Create a Ticket

Creates and return a new Ticket

- Require Authentication: `true`
  - Method: `POST`
  - URL: `/api/tickets`
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "title": "My printer doesn't work",
  "description": "I am having a problem with my computer, it seems not be recognizing the printer, please I need your help",
  "clientId": 1
}
```

- Successful Response
  - Status Code: 201
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "id": 11,
  "title": "My printer doesn't work",
  "description": "I am having a problem with my computer, it seems not be recognizing the printer, please I need your help",
  "checkIn": null,
  "checkOut": null,
  "clientId": 1,
  "statusId": 1,
  "hashedId": "s_fwq!Xq!D",
  "createdBy": 1,
  "updatedAt": "2025-08-26T18:02:20.795Z",
  "createdAt": "2025-08-26T18:02:20.795Z"
}
```

- Error Response
  - Status Code: 400
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Bad Request",
  "errors": {
    "title": "Title is required",
    "clientId": "Client Id is required"
  }
}
```

### Add a Part to a Ticket based on the Ticket's Id

Create and return a new Part for a Ticket specified by id.

- Require Authentication: `true`
- Require proper Authorization: Ticket must be assigned to the Current User.
- Request:
  - Method: `POST`
  - URL: `/api/tickets/:ticketId/parts`
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "name": "Hard Drive",
  "description": "A 512Gb SSD Drive",
  "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/1/1a/2023_Dysk_SSD_Patriot_P210_2TB.jpg"
}
```

- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "id": 23,
  "name": "Hard Drive",
  "description": "A 512Gb SSD Drive",
  "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/1/1a/2023_Dysk_SSD_Patriot_P210_2TB.jpg",
  "ticketId": 1,
  "updatedAt": "2025-08-26T18:16:25.300Z",
  "createdAt": "2025-08-26T18:16:25.300Z"
}
```

- Error Response: Unauthorized
  - Status Code: 403
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Unauthorized"
}
```

### Edit a Ticket

Updates and return an existing ticket.

- Require Authorization: `true`
- Require Proper Authorization: Ticket must belong to the current user
- Request:
  - Method: `PUT`
  - URL `/api/tickets/:ticketId`
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "title": "My printer doesn't work",
  "description": "I am having a problem with my computer, it seems not be recognizing the printer, please I need your help",
  "status": "Created",
  "checkIn": "2024-04-01",
  "checkOut": "2024-05-03",
  "status": "completed"
}
```

- Successful Response
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "id": 1,
  "title": "My printer doesn't work",
  "createdBy": 1,
  "clientId": 1,
  "description": "I am having a problem with my computer, it seems not be recognizing the printer, please I need your help",
  "checkIn": "2024-04-01T00:00:00.000Z",
  "checkOut": "2024-05-03T00:00:00.000Z",
  "statusId": 1,
  "hashedId": "0XxR/v.CGH",
  "createdAt": "2025-08-26T14:16:29.146Z",
  "updatedAt": "2025-08-26T18:22:33.564Z"
}
```

- Error Response: Couldn't find a Ticket based on the Specified Id
  - Status Code: 404
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Ticket couldn't be found"
}
```

### Delete a Ticket

Deletes an existing Ticket.

- Require Authentication: `true`
- Require Proper Authorization: Ticket must belong to the current user
- Request:
  - Method: `DELETE`
  - URL: `/api/tickets/:ticketId`
  - Body: none
- Successful Response:
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Successfully Deleted"
}
```

- Error Response: Couldn't find a Ticket with the specified Id
  - Status Code: 404
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Ticket couldn't be found"
}
```

## Parts

### Get All Parts

Returns all Parts

- Require Authentication: `true`
- Request:
  - Method: `GET`
  - URL: `/api/parts`
  - Body: none
- Successful Response:
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
[
  {
    "id": 3,
    "name": "Solid State Drive (SSD)",
    "description": "500GB SSD for performance improvement",
    "imageUrl": "https://i5.walmartimages.com/seo/WD-Blue-2-5-Inch-3D-NAND-SATA-SSD-500GB-WDBNCE5000PNC-WRSN_48196402-2f69-45b8-97f0-5f5f486e8801.1a509058826f46b18c7340a2d5902cbc.jpeg",
    "Ticket": {
      "id": 2,
      "title": "Slow Computer Performance",
      "createdBy": 2,
      "clientId": 2,
      "description": "My computer is very slow, it takes a long time to load applications.",
      "checkIn": null,
      "checkOut": null,
      "statusId": 1,
      "hashedId": "BSU8IfQPUe",
      "createdAt": "2025-08-26T14:16:29.146Z",
      "updatedAt": "2025-08-26T14:16:29.146Z"
    }
  },
  {
    "id": 4,
    "name": "Memory Upgrade",
    "description": "16GB DDR4 RAM for desktop",
    "imageUrl": "https://m.media-amazon.com/images/I/51L+S7mtXdL.jpg",
    "Ticket": {
      "id": 2,
      "title": "Slow Computer Performance",
      "createdBy": 2,
      "clientId": 2,
      "description": "My computer is very slow, it takes a long time to load applications.",
      "checkIn": null,
      "checkOut": null,
      "statusId": 1,
      "hashedId": "BSU8IfQPUe",
      "createdAt": "2025-08-26T14:16:29.146Z",
      "updatedAt": "2025-08-26T14:16:29.146Z"
    }
  },
  {
    "id": 5,
    "name": "Outlook Setup Guide",
    "description": "Guide to set up Outlook for email configuration",
    "imageUrl": "https://cirasync.com/wp-content/uploads/2022/09/Add-an-email-account-to-outlook.jpg",
    "Ticket": {
      "id": 3,
      "title": "Need Help with Email Setup",
      "createdBy": 3,
      "clientId": 3,
      "description": "I'm having trouble setting up my email on Outlook.",
      "checkIn": "2021-06-01T14:00:00.000Z",
      "checkOut": null,
      "statusId": 2,
      "hashedId": "OZx63HaF7*",
      "createdAt": "2025-08-26T14:16:29.146Z",
      "updatedAt": "2025-08-26T14:16:29.146Z"
    }
  }
]
```

### Get All Parts by a Ticket's Id

Returns all the Parts that belong to a Ticket specified by Id

- Require Authentication: `false`
- Request:
  - Method: `GET`
  - URL: `/api/tickets/:ticketId/parts`
  - Body: none
- Successful Response:
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "Parts": [
    {
      "id": 3,
      "name": "Solid State Drive (SSD)",
      "description": "500GB SSD for performance improvement",
      "ticketId": 2,
      "imageUrl": "https://i5.walmartimages.com/seo/WD-Blue-2-5-Inch-3D-NAND-SATA-SSD-500GB-WDBNCE5000PNC-WRSN_48196402-2f69-45b8-97f0-5f5f486e8801.1a509058826f46b18c7340a2d5902cbc.jpeg",
      "createdAt": "2025-08-26T14:16:29.151Z",
      "updatedAt": "2025-08-26T14:16:29.151Z"
    },
    {
      "id": 4,
      "name": "Memory Upgrade",
      "description": "16GB DDR4 RAM for desktop",
      "ticketId": 2,
      "imageUrl": "https://m.media-amazon.com/images/I/51L+S7mtXdL.jpg",
      "createdAt": "2025-08-26T14:16:29.151Z",
      "updatedAt": "2025-08-26T14:16:29.151Z"
    },
    {
      "id": 13,
      "name": "Wireless Mouse",
      "description": "Logitech wireless mouse for computer use",
      "ticketId": 2,
      "imageUrl": "https://resource.logitechg.com/w_692,c_lpad,ar_4:3,q_auto,f_auto,dpr_1.0/d_transparent.gif/content/dam/gaming/en/products/g502x-lightspeed/gallery/g502x-lightspeed-gallery-1-black.png",
      "createdAt": "2025-08-26T14:16:29.151Z",
      "updatedAt": "2025-08-26T14:16:29.151Z"
    }
  ]
}
```

- Error Response: Couldn't find a Ticket based on the specified Id
  - Status Code: 404
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Ticket couldn't be found"
}
```

### Edit a Part

Update and return an existing part

- Require Authentication: `true`
- Require Proper Authorization: Ticket where part belongs must belong to the current user.
- Request:
  - Method: `PUT`
  - URL: `/api/parts/:partId`
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "name": "Webcam 2.0",
  "description": "A Dell HD Webcam",
  "imageUrl": "https://i5.walmartimages.com/asr/b109f053-d441-4067-8e1f-3900cd130851.83347aafc41e87a584e0bb5147f8dc9b.jpeg?odnHeight=768&odnWidth=768&odnBg=FFFFFF"
}
```

- Successful Response:
  - Status Code: 200
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "id": 24,
  "name": "Webcam 2.0",
  "description": "A Dell HD Webcam",
  "ticketId": 11,
  "imageUrl": "https://i5.walmartimages.com/asr/b109f053-d441-4067-8e1f-3900cd130851.83347aafc41e87a584e0bb5147f8dc9b.jpeg?odnHeight=768&odnWidth=768&odnBg=FFFFFF",
  "createdAt": "2025-08-26T18:50:34.814Z",
  "updatedAt": "2025-08-26T18:51:44.329Z"
}
```

- Error Response: Ticket Doesn't belong to the current User
  - Status Code: 403.
  - Headers: `Content-Type: application/json`
  - Body:

```json
{
  "message": "Unauthorized"
}
```
